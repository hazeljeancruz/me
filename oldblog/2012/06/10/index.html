<!DOCTYPE html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta charset="utf-8" />
<link rel="stylesheet" href="/960/css/reset.css" />
<link rel="stylesheet" href="/960/css/text.css" />
<link rel="stylesheet" href="/960/css/960_24_col.css" />
<link rel="stylesheet" href="/960/css/demo.cssS" />
<link rel="stylesheet" href="/style.css" />
<link rel="shortcut icon" type="image/x-icon" href="/img/favicon.ico">
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-8027537-3']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>
<title>
Wojciech A. Koszek,
Cross-compile GNU assembler for MIPS
</title>
</head>
<body>


<div class="container_24">
	<!-- SPACE -->
	<div class="grid_24">
		<br>
	</div>
	<div class="clear"></div>


	<!-- HEADER -->
	<div class="grid_4" id="menu">
		&nbsp;
	</div>
	<div class="grid_20" id="header">
		<p>
			Wojciech Adam Koszek &mdash; Homepage
		</p>
	</div>
	<div class="clear"></div>


	<!-- SPACE -->
	<div class="grid_24">
		<br>
	</div>
	<div class="clear"></div>


	<!-- MAIN:MENU -->
	<div class="grid_2" id="menu">
<a href="http://www.koszek.com"/>BLOG</a>
<br>
<br>
<a href="http://www.koszek.com/books.html"/>BOOKS</a>
<br>
<br>
<a href="http://www.koszek.com/software.html"/>SOFTWARE</a>
<br>
<br>
<a href="http://www.koszek.com/papers.html"/>PAPERS</a>
<br>
<br>
	</div>
	<div class="grid_2">
	<!-- SPACE -->
		&nbsp;
	</div>

	<!-- MAIN:CONTENT -->
	<div class="grid_17" id="content">
<h2>Cross-compile GNU assembler for MIPS</h2>

<p><strong><em>by Wojciech Koszek</em></strong></p>

<!-- AddThis Button BEGIN -->
<div class="addthis_toolbox addthis_default_style ">
<a class="addthis_button_preferred_1"></a>
<a class="addthis_button_preferred_2"></a>
<a class="addthis_button_preferred_3"></a>
<a class="addthis_button_preferred_4"></a>
<a class="addthis_button_compact"></a>
<a class="addthis_button_google_plusone"></a>
<!-- <a class="addthis_counter addthis_bubble_style"></a> -->
</div>
<script type="text/javascript" src="http://s7.addthis.com/js/250/addthis_widget.js#pubid=xa-4f9b57ef259d6c68"></script>
<br>
<!-- AddThis Button END -->


<p>Just a short note, not to have to walk through the Web each time I 
want to get some strange opcodes generated.</p>

<p>Today "strange" means "MIPS". "Nobody uses MIPS", you say? Well -- I still believe MIPS
is the cleanest RISC architecture available today. So yes, I want to have
something translate:</p>

<pre><code>_start:
    addi    $2, $2, 123
    addi    $3, $3, 321
    add $4, $2, $3

    addi    $5, $5, 1
    addi    $6, $6, 2
    or  $7, $5, $6

    addi    $8, $8, 0xf
    addi    $9, $9, 0x3
    and $10, $8, $9
</code></pre>

<p>To:</p>

<pre><code>0x2042007b
0x20630141
0x00432020
0x20a50001
0x20c60002
0x00a63825
0x2108000f
0x21290003
0x01095024
</code></pre>

<p>For me. So first let me present steps for building the GNU assembler for
MIPS. Steps:</p>

<pre><code>wget ftp://sourceware.org/pub/binutils/snapshots/binutils-2.22.52.tar.bz2
tar xjf binutils-2.22.52.tar.bz2
cd binutils-2.22.52
mkdir build
../configure --target=mips --prefix=${HOME}/bin/mips
make
make install
set path=($path ${HOME}/bin/mips/bin)
</code></pre>

<p>Now that I have MIPS assembler, I have created a simple <code>makefile</code> for
myself, which translates opcodes from generated object file to hexadecimal
opcodes:</p>

<pre><code>imem.hex: imem.s
    mips-as -o imem.o imem.s
    mips-objcopy -O binary imem.o imem.bin
    mips-objdump -d imem.o &gt; imem.dump
    sed '1,7d' imem.dump | awk '{ print "0x"$$2 }' &gt; imem.hex
</code></pre>

<p>Thanks to these several steps, I have a simple infrastructure to play with
MIPS opcodes.</p>
		<br><br><br>
		&copy; 2012-2014 Wojciech Adam Koszek &lt;wkoszek@FreeBSD.org&gt;
		<br>
<hr>
<div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'koszek'; // required: replace example with your forum shortname
    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
	var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
	dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
	(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<!-- <a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a> -->

	</div>
	<!-- SPACE -->
	<div class="grid_1" id="sa">
		&nbsp;
	</div>

	<!-- ADDS -->
	<div class="grid_2" id="lr">

<iframe src="http://rcm.amazon.com/e/cm?lt1=_blank&bc1=FFFFFF&IS2=1&npa=1&bg1=FFFFFF&fc1=000000&lc1=FF0000&t=wojcadamkoszh-20&o=1&p=8&l=as4&m=amazon&f=ifr&ref=ss_til&asins=0120884216" style="width:120px;height:240px;" scrolling="no" marginwidth="0" marginheight="0" frameborder="0"></iframe>

<iframe src="http://rcm.amazon.com/e/cm?lt1=_blank&bc1=FFFFFF&IS2=1&npa=1&bg1=FFFFFF&fc1=000000&lc1=FF0000&t=wojcadamkoszh-20&o=1&p=8&l=as4&m=amazon&f=ifr&ref=ss_til&asins=0131420445" style="width:120px;height:240px;" scrolling="no" marginwidth="0" marginheight="0" frameborder="0"></iframe>

<iframe src="http://rcm.amazon.com/e/cm?lt1=_blank&bc1=FFFFFF&IS2=1&npa=1&bg1=FFFFFF&fc1=000000&lc1=FF0000&t=wojcadamkoszh-20&o=1&p=8&l=as4&m=amazon&f=ifr&ref=ss_til&asins=0123744938" style="width:120px;height:240px;" scrolling="no" marginwidth="0" marginheight="0" frameborder="0"></iframe>

<iframe src="http://rcm.amazon.com/e/cm?lt1=_blank&bc1=FFFFFF&IS2=1&npa=1&bg1=FFFFFF&fc1=000000&lc1=FF0C00&t=wojcadamkoszh-20&o=1&p=8&l=as4&m=amazon&f=ifr&ref=ss_til&asins=0123747503" style="width:120px;height:240px;" scrolling="no" marginwidth="0" marginheight="0" frameborder="0"></iframe>

	</div>
	<div class="clear"></div>

</div>
</body>
</html

